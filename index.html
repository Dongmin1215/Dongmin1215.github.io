<!DOCTYPE html>
<html class="no-js" lang="ko">

  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>민수♥동민 청첩장</title>
    <meta name="description" content="결혼식에 초대합니다!" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:url" content="https://Dongmin1215.github.io/wedding/" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="민수♥동민 청첩장" />
    <meta property="og:description" content="결혼식에 초대합니다!" />
    <meta property="og:image" content="https://Dongmin1215.github.io/wedding/src/images/visual/main.jpg" />
    <meta name="theme-color" content="#fafafa" />
    <link rel="manifest" href="site.webmanifest" />
    <link rel="shortcut icon" href="src/images/icon/favicon.png" />
    <link rel="icon" href="src/images/icon/favicon.png" />
    <link rel="apple-touch-icon" href="src/images/icon/favicon.png" />
    <link rel="stylesheet" href="src/css/reset.css" />
    <script src="https://code.jquery.com/jquery-latest.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="src/css/fontawesome.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="src/css/main.css?20200824" />
    <link rel="stylesheet" href="src/css/lightgallery.min.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700;800&family=Nanum+Myeongjo:wght@400;700;800&display=swap"
      rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.4.2/gsap.min.js"></script>
    <script src="src/js/lib/modernizr-3.11.2.min.js"></script>
    <script src="src/js/lib/lightgallery.min.js"></script>
    <script src="src/js/lib/lg-thumbnail.min.js"></script>
    <script src="src/js/lib/lg-fullscreen.min.js"></script>
    <script src="src/js/lib/kakao.min.js"></script>
  </head>

<body>
  <main>
    <h1 class="blind">청첩장</h1>
    <section class="info">
      <h2 class="blind">결혼식 정보</h2>
      <strong id="dday" class="dday">&nbsp;</strong>
      <img src="src/images/visual/main.jpg" alt="신랑신부사진" class="img_visual" />
      <p class="tit"><em>김민수</em> 그리고 <em>이동민</em></p>
      <time datetime="2022-02-12 12:30">2022년 2월 12일 토요일 오후 12시 30분</time>
      <address>그랜드 워커힐 호텔 1층 워커홀</address>
    </section>
    <section class="greeting">
      <h2 class="blind">인사말</h2>
      <ul class="message">
        <li>
          <p>너의 웃는 모습이 좋아</p>
        </li>
        <li>
          <p>너를 웃게 해 줄 것들을 찾아다녔다.</p>
        </li>
        <li>
          <p>너의 웃음을 보고 싶었다.</p>
        </li>
        <li>
          <p>세상 가장 맑고도 아름다운</p>
        </li>
        <li>
          <p>그 미소를 짓게 해주고 싶었다.</p>
        </li>
        <li>
          <p>어떤 순간에라도 어떤 일을 해서라도</p>
        </li>
        <li>
          <p>너를 위해</p>
        </li>
      </ul>
      <div class="family">
        <p><em>김태훈</em><em>류성희</em>의 아들 <strong>민수</strong></p>
        <p><em>이제훈</em><em>김현혜</em>의 &nbsp;딸 &nbsp;<strong>동민</strong></p>
      </div>
    </section>
    <section class="calendar">
      <h2 class="blind">달력</h2>
      <div class="contents">
        <div class="header">
          <span class="tit"><em><i class="fa fa-calendar"></i> 2</em> Feb</span>
          <time datetime="2022-02-12 12:30">Sat. pm 12:30</time>
        </div>
        <time datetime="2020-11">
          <time datetime="2022-W45" class="row">
            <time datetime="2022-01-30">&nbsp;</time>
            <time datetime="2022-01-31">&nbsp;</time>
            <time datetime="2022-02-01">1</time>
            <time datetime="2022-02-02">2</time>
            <time datetime="2022-02-03">3</time>
            <time datetime="2022-02-04">4</time>
            <time datetime="2022-02-05">5</time>
          </time>
          <time datetime="2022-W45" class="row">
            <time datetime="2022-02-06">6</time>
            <time datetime="2022-02-07">7</time>
            <time datetime="2022-02-08">8</time>
            <time datetime="2022-02-09">9</time>
            <time datetime="2022-02-10">10</time>
            <time datetime="2022-02-11">11</time>
            <time class = "active" datetime="2022-02-12">12</time>
          </time>
          <time datetime="2022-W45" class="row">
            <time datetime="2022-02-13">13</time>
            <time datetime="2022-02-14">14</time>
            <time datetime="2022-02-15">15</time>
            <time datetime="2022-02-16">16</time>
            <time datetime="2022-02-17">17</time>
            <time datetime="2022-02-18">18</time>
            <time datetime="2022-02-19">19</time>
          </time>
          <time datetime="2022-W45" class="row">
            <time datetime="2022-02-20">20</time>
            <time datetime="2022-02-21">21</time>
            <time datetime="2022-02-22">22</time>
            <time datetime="2022-02-23">23</time>
            <time datetime="2022-02-24">24</time>
            <time datetime="2022-02-25">25</time>
            <time datetime="2022-02-26">26</time>
          </time>
          <time datetime="2022-W45" class="row">
            <time datetime="2022-02-27">27</time>
            <time datetime="2022-02-28">28</time>
            <time datetime="2022-03-01">&nbsp;</time>
            <time datetime="2022-03-02">&nbsp;</time>
            <time datetime="2022-03-03">&nbsp;</time>
            <time datetime="2022-03-04">&nbsp;</time>
            <time datetime="2022-03-05">&nbsp;</time>
          </time> 
        </time>
      </div>
    </section>
    <section class="gallery">
      <h2 class="blind">갤러리</h2>
      <div class="tit">
        <span class="ico husband">&nbsp;</span>
        <span>Gallery</span>
        <span class="ico wife">&nbsp;</span>
      </div>
      <ul id="gallery" class="container">
        <li class="item_1" data-src="src/images/gallery/1.jpg">
          <img src="src/images/gallery/thumb-1.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_2" data-src="src/images/gallery/2.jpg">
          <img src="src/images/gallery/thumb-2.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_3" data-src="src/images/gallery/3.jpg">
          <img src="src/images/gallery/thumb-3.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_4" data-src="src/images/gallery/4.jpg">
          <img src="src/images/gallery/thumb-4.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_5" data-src="src/images/gallery/5.jpg">
          <img src="src/images/gallery/thumb-5.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_6" data-src="src/images/gallery/6.jpg">
          <img src="src/images/gallery/thumb-6.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_7" data-src="src/images/gallery/7.jpg">
          <img src="src/images/gallery/thumb-7.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_8" data-src="src/images/gallery/8.jpg">
          <img src="src/images/gallery/thumb-8.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_9" data-src="src/images/gallery/9.jpg">
          <img src="src/images/gallery/thumb-9.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_10" data-src="src/images/gallery/10.jpg">
          <img src="src/images/gallery/thumb-10.jpg" alt="스튜디오 촬영 사진" />
        </li>
        <li class="item_11" data-src="src/images/gallery/11.jpg">
          <img src="src/images/gallery/thumb-11.jpg" alt="스튜디오 촬영 사진" />
        </li>
      </ul>
      <p class="description">이미지를 클릭하시면 확대해서 볼 수 있습니다.</p>
    </section>
    <section class="location">
      <h2 class="blind">오시는길</h2>
      <div class="header">
        <address class="addr_fst">
          <i class="fa fa-building"></i> 그랜드 워커힐 호텔 1층 워커홀
        </address>
        <address class="addr_lst">서울 광진구 워커힐로 177 (광장동 21)</address>
        <a href="tel:+024555000" class="tel">Tel. 02-455-5000</a>
      </div>
      <div class="map">
        <div class="view">
          <img src="src/images/location/map.png" alt="지도 이미지" />
        </div>

      </div>
    </section>
    <section class="guide">
      <h2 class="blind">안내사항</h2>
      <ul>
        <li class="bus">
          <dl>
            <dt><i class="fa fa-bus"></i> 지하철 및 셔틀 버스 안내</dt>
            <dd> 2호선 강변역 1번 출구에서 80m 직진 <br />
              횡단보도 건너 테크노마트 건너편 탑승</dd>
            <dd> 5호선 광나루역 2번 출구에서 횡단보도 건너<br />
              광진 청소년 수련관 정류장 탑승</dd>
            <dd class = "noti">
              15분 간격으로 운행됩니다. 
            </dd>
          </dl>
        </li>
        <li>
          <dl>
            <dt><i class="fa fa-car"></i> 주차 안내</dt>
            <dd>주차장 무료 이용이 가능합니다.</dd>
            <dd>그랜드 워커힐 위쪽 주차타워를 이용해 주시기 바랍니다. </dd>
          </dl>
        </li>
      </ul>
    </section>
    <section class="gallery">
      <h2 class="blind">방명록</h2>
      <div class="tit">
        <span class="ico husband">&nbsp;</span>
        <span>방명록</span>
        <span class="ico wife">&nbsp;</span>
      </div>
      <div class="addComment">
        <form>
          <div class="form-row">
            <div class="col commentInput">
              <input type="text" class="form-control" id = "username" maxlength="10" placeholder="이름">
            </div>
            <div class="col commentInput">
              <input type="text" class="form-control"  id="text" maxlength="100" placeholder="메시지">
            </div>
            <div class="col">
              <button type="button" class="btn btn-outline-dark" id="pushComment">보내기</button>
            </div>
          </div>
        </form>
      </div>
      <div id="comments"></div>
      <div class="commentMore">
        <button type="button" class="btn btn-outline-success" id="pullComments">더 불러오기</button>
      </div>
    </section>
    <aside class="share">
      <div id="fb-root"></div>
      <h2 class="blind">공유하기</h2>
      <ul>
        <li>
          <button type="button" id="btnKakaoTalk" class="kakaotalk">
            <span>카카오톡<br />공유하기 </span>
          </button>
        </li>
        <li>
          <button type="button" id="btnQRcode" class="qrcode">
            <span>QR코드<br />발급받기</span>
          </button>
        </li>
      </ul>
    </aside>
  </main>
  <script src="src/js/main.min.js"></script>
  <script type="module">
    // 이 코드를 읽을 수 있으시다면..
    // 너그러히 못 본 척 해주세요...
    // import를 하고 싶은데.. 다른 js 파일로 어떻게 빼는걸까..

    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getDatabase, ref, set, push, onValue, off, query, limitToLast } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";
    const firebaseConfig = {
      apiKey: "AIzaSyDW8o_odngQSWuhoxTOVKLdA-ukgVv4m6E",
      authDomain: "msdm-mobile-invitation.firebaseapp.com",
      databaseURL: "https://msdm-mobile-invitation-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "msdm-mobile-invitation",
      storageBucket: "msdm-mobile-invitation.appspot.com",
      messagingSenderId: "440320271279",
      appId: "1:440320271279:web:485377ffbeb9d8ee68455a"
    }

    const app = initializeApp(firebaseConfig)
    const db = getDatabase()
    const commentListRef = ref(db, 'comments');
    let maxCommentCount = 10
    const pageSize = 10

    function checkComment(username, text) {
      if (typeof(username) !== "string" || typeof(text) !== "string") return false
      if (username.length < 1 || username.length > 10) return false
      if (username.includes("\n")) return false
      if (text.length < 1 || text.length > 100) return false
      if (text.includes("\n")) return false
      return true
    }

    function pushComment() {
      const username = $("input#username").value
      const text = $("input#text").value
      if (!checkComment(username, text)) {
        alert("메시지 형식이 올바르지 않습니다.")
        return
      }
      const commentRef = push(commentListRef);
      set(commentRef, {
        'username': username,
        'text': text
      });
      maxCommentCount += 1
      pullComments()
      $("input#username").value = ""
      $("input#text").value = ""
    }

    function pullComments() {
      onValue(commentListRef, (comments) => {
        let filteredComments = []
        comments.forEach((comment) => {
          const value = comment.val()
          if (checkComment(value.username, value.text)) filteredComments.push(value)
        })
        filteredComments = filteredComments.reverse().slice(0, maxCommentCount)

        let div = document.createElement("div")
        let table = document.createElement("table")
        table.className = "commentTable"
        div.appendChild(table)
        let tbody = document.createElement("tbody")
        table.appendChild(tbody)

        filteredComments.forEach((value) => {
          let commentList = document.createElement("tr")
          tbody.appendChild(commentList)

          let commentUser = document.createElement("td")
          commentList.appendChild(commentUser)
          commentUser.className = "commentUser"
          commentUser.textContent = value.username.split("\n")[0].substring(0, 10)

          let commentText = document.createElement("td")
          commentList.appendChild(commentText)
          commentText.className = "commentText"
          commentText.textContent = value.text.split("\n")[0].substring(0, 100)
        })
        $("#comments").innerHTML = div.innerHTML
      }, {onlyOnce: true})
    }

    $("button#pushComment").onclick = pushComment
    $("button#pullComments").onclick = () => {
      maxCommentCount += pageSize
      pullComments()
    }
    pullComments()


  </script>
</body>
</html>

